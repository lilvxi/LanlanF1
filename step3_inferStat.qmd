---
title: "Statistical Analysis of Fatal Events in Formula 1 Racing (1950-2024)"
format:
  html:
    theme: cosmo
    toc: true
    toc-depth: 3
    code-fold: true
    code-tools: false
    df-print: paged
    fig-width: 10
    fig-height: 6
    fig-dpi: 300
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
library(tidyverse)
library(broom)
library(car)  # For ANOVA
library(knitr)
load('dataOK.RData')
```

## 1. Introduction

This analysis explores the statistical relationships between fatal events in Formula 1 racing and various factors from 1950 to 2024. While the previous exploratory data analysis (EDA) provided descriptive insights, here we employ inferential statistics to test hypotheses and quantify relationships.

Key questions we aim to address:

1. How has the risk of fatal events changed over time?
2. Do driver characteristics (age and experience) relate to fatal event risk?
3. Are certain circuits or geographic regions associated with higher fatality rates?
4. Do constructors (teams) differ in safety records?
5. Which factors remain significant when controlling for others?

## 2. Data Preparation

We first prepare the data for statistical analysis by creating derived variables and categorizing data appropriately.

```{r data-prep}
# Load preprocessed data
# Note: The dataOK dataset should be loaded before running this code

# Prepare data for statistical analysis
stats_data <- dataOK %>%
  # Create binary outcome variable
  mutate(
    is_fatal = ifelse(driver.fatal == "Death", 1, 0),
    
    # Transform variables for analysis
    decade = paste0(floor(year/10) * 10, "s"),
    driver_age = as.numeric(difftime(as.Date(date), as.Date(driver.dob), units = "days") / 365.25),
    
    # Create experience proxy based on prior races
    driver_id_year = paste(driverId, year, sep = "_")
  ) %>%
  # Group by driver and year to get cumulative race count
  group_by(driverId) %>%
  arrange(date) %>%
  mutate(
    driver_experience = row_number(),
    driver_experience_cat = cut(driver_experience, 
                               breaks = c(0, 10, 25, 50, Inf),
                               labels = c("Rookie (1-10)", "Experienced (11-25)", 
                                         "Veteran (26-50)", "Elite (51+)"),
                               right = FALSE)
  ) %>%
  ungroup()

# Display summary statistics
summary_stats <- stats_data %>%
  summarize(
    Total_Entries = n(),
    Unique_Drivers = n_distinct(driver.name),
    Unique_Races = n_distinct(Race),
    Unique_Circuits = n_distinct(circuit.name),
    Unique_Constructors = n_distinct(constructor.name),
    Total_Fatal_Events = sum(is_fatal),
    Overall_Fatality_Rate = mean(is_fatal) * 100
  )

kable(summary_stats, caption = "Summary Statistics of Formula 1 Dataset")
```

## 3. Temporal Analysis of Fatal Events

### 3.1 Decade Comparison

We analyze changes in fatality rates by decade, which might reveal non-linear patterns or safety eras.

```{r decade-analysis}
# Chi-square test for decade differences
decade_test <- stats_data %>%
  group_by(decade) %>%
  summarize(
    fatal_events = sum(is_fatal),
    non_fatal_events = n() - fatal_events,
    .groups = "drop"
  )

decade_contingency <- as.matrix(decade_test[, c("fatal_events", "non_fatal_events")])
rownames(decade_contingency) <- decade_test$decade
decade_chi <- chisq.test(decade_contingency)

# Display contingency table
kable(decade_test, caption = "Fatal Events by Decade")

# Decade-wise fatality rates with confidence intervals
decade_stats <- stats_data %>%
  group_by(decade) %>%
  summarize(
    total_events = n(),
    fatal_events = sum(is_fatal),
    fatality_rate = fatal_events / total_events,
    # Wilson score interval for proportion CI
    ci_lower = prop.test(fatal_events, total_events)$conf.int[1],
    ci_upper = prop.test(fatal_events, total_events)$conf.int[2],
    .groups = "drop"
  )

# Visualize temporal trend with confidence intervals
temporal_plot <- ggplot(decade_stats, aes(x = decade, y = fatality_rate)) +
  geom_bar(stat = "identity", fill = "#3a86ff", alpha = 0.7) +
  geom_errorbar(aes(ymin = ci_lower, ymax = ci_upper), width = 0.2, color = "#e63946") +
  labs(
    title = "Fatality Rate by Decade with 95% Confidence Intervals",
    subtitle = paste("Chi-Square Test: χ²(", decade_chi$parameter, ") = ", 
                    round(decade_chi$statistic, 2), 
                    ", p", ifelse(decade_chi$p.value < 0.001, " < 0.001", 
                                 paste(" = ", round(decade_chi$p.value, 3)))),
    x = "Decade",
    y = "Fatality Rate"
  ) +
  scale_y_continuous(labels = scales::percent_format(accuracy = 0.01)) +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),
    plot.subtitle = element_text(hjust = 0.5, size = 12)
  )

temporal_plot
```

The chi-square test reveals significant differences in fatality rates across decades (χ²(`r decade_chi$parameter`) = `r round(decade_chi$statistic, 2)`, p < 0.001). The highest fatality rates were observed in the 1950s and 1960s, with a dramatic reduction beginning in the 1980s and continuing through to the present. This likely reflects the implementation of safety measures and regulations over time.

## 4. Driver Factors and Fatal Events

### 4.1 Driver Age and Fatality Risk

We examine whether a driver's age is associated with the risk of fatal events.

```{r driver-age}
# Age and fatality relationship
age_model <- glm(is_fatal ~ driver_age, 
                 family = binomial(link = "logit"), 
                 data = filter(stats_data, !is.na(driver_age)))

age_model_summary <- tidy(age_model, conf.int = TRUE, exponentiate = TRUE) %>%
  mutate(across(where(is.numeric), ~round(., 4)))

# Display model results
kable(age_model_summary, 
      caption = "Logistic Regression of Fatal Events by Driver Age",
      col.names = c("Term", "Odds Ratio", "Std. Error", "z value", "p-value", "Lower 95% CI", "Upper 95% CI"))

# Manual calculation of predicted probabilities for visualization
age_range <- seq(20, 55, by = 5)
age_predictions <- data.frame(
  driver_age = age_range,
  predicted = predict(age_model, newdata = data.frame(driver_age = age_range), 
                     type = "response")
)

# Visualize predicted probabilities
age_plot <- ggplot(age_predictions, aes(x = driver_age, y = predicted)) +
  geom_line(color = "#3a86ff", size = 1.2) +
  labs(
    title = "Predicted Probability of Fatal Event by Driver Age",
    subtitle = paste("Logistic Regression: OR = ", 
                    round(exp(coef(age_model)[2]), 4),
                    ", p", ifelse(summary(age_model)$coefficients[2,4] < 0.001, 
                                 " < 0.001", 
                                 paste(" = ", round(summary(age_model)$coefficients[2,4], 3)))),
    x = "Driver Age (years)",
    y = "Predicted Probability of Fatal Event"
  ) +
  scale_y_continuous(labels = scales::percent_format(accuracy = 0.01)) +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),
    plot.subtitle = element_text(hjust = 0.5, size = 12)
  )

age_plot
```

The logistic regression indicates that each one-year increase in driver age is associated with an odds ratio of `r round(age_model_summary$estimate[2], 4)` (95% CI: `r round(age_model_summary$conf.low[2], 4)` - `r round(age_model_summary$conf.high[2], 4)`) for fatal events. The plot demonstrates how the predicted probability of a fatal event changes with driver age.

### 4.2 Comparing Mean Age in Fatal vs. Non-Fatal Events

```{r age-t-test}
# Two-sample t-test for age difference between fatal and non-fatal cases
age_t_test <- t.test(driver_age ~ is_fatal, data = filter(stats_data, !is.na(driver_age)))

# Display t-test results
kable(tidy(age_t_test), caption = "T-test Results for Age Difference in Fatal vs. Non-Fatal Events")

age_comparison_data <- stats_data %>%
  filter(!is.na(driver_age)) %>%
  group_by(fatal = factor(is_fatal, labels = c("Non-Fatal", "Fatal"))) %>%
  summarize(
    mean_age = mean(driver_age, na.rm = TRUE),
    sd_age = sd(driver_age, na.rm = TRUE),
    n = n(),
    se = sd_age / sqrt(n),
    ci_lower = mean_age - qt(0.975, n-1) * se,
    ci_upper = mean_age + qt(0.975, n-1) * se,
    .groups = "drop"
  )

# Visualize mean age comparison
age_comparison_plot <- ggplot(age_comparison_data, aes(x = fatal, y = mean_age, fill = fatal)) +
  geom_bar(stat = "identity", alpha = 0.7) +
  geom_errorbar(aes(ymin = ci_lower, ymax = ci_upper), width = 0.2) +
  labs(
    title = "Mean Driver Age: Fatal vs. Non-Fatal Events",
    subtitle = paste("t-test: t(", round(age_t_test$parameter, 1), ") = ", 
                    round(age_t_test$statistic, 2), 
                    ", p", ifelse(age_t_test$p.value < 0.001, " < 0.001", 
                                 paste(" = ", round(age_t_test$p.value, 3)))),
    x = "",
    y = "Mean Driver Age (years)"
  ) +
  scale_fill_manual(values = c("Non-Fatal" = "#3a86ff", "Fatal" = "#e63946")) +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),
    plot.subtitle = element_text(hjust = 0.5, size = 12),
    legend.position = "none"
  )

age_comparison_plot
```

A two-sample t-test shows that the mean age of drivers involved in fatal events (`r round(age_comparison_data$mean_age[age_comparison_data$fatal == "Fatal"], 2)` years) is `r ifelse(age_t_test$estimate[2] > age_t_test$estimate[1], "higher", "lower")` than the mean age in non-fatal events (`r round(age_comparison_data$mean_age[age_comparison_data$fatal == "Non-Fatal"], 2)` years). This difference `r ifelse(age_t_test$p.value < 0.05, "is", "is not")` statistically significant (p `r ifelse(age_t_test$p.value < 0.001, "< 0.001", paste("=", round(age_t_test$p.value, 3)))`) and may reflect `r ifelse(age_t_test$estimate[2] > age_t_test$estimate[1], "increased risk with age", "protective effects of experience")`.

### 4.3 Driver Experience and Fatality Risk

Experience may be as important as age in determining risk, so we analyze this relationship.

```{r driver-experience}
# Chi-square test for experience categories
experience_test <- stats_data %>%
  group_by(driver_experience_cat) %>%
  summarize(
    fatal_events = sum(is_fatal),
    non_fatal_events = n() - fatal_events,
    .groups = "drop"
  ) %>%
  filter(!is.na(driver_experience_cat))

experience_contingency <- as.matrix(experience_test[, c("fatal_events", "non_fatal_events")])
rownames(experience_contingency) <- experience_test$driver_experience_cat
experience_chi <- chisq.test(experience_contingency)

# Display contingency table
kable(experience_test, caption = "Fatal Events by Driver Experience Level")

# Calculate experience-wise fatality rates with CIs
experience_stats <- stats_data %>%
  group_by(driver_experience_cat) %>%
  summarize(
    total_events = n(),
    fatal_events = sum(is_fatal),
    fatality_rate = fatal_events / total_events,
    # Wilson score interval for proportion CI
    ci_lower = prop.test(fatal_events, total_events)$conf.int[1],
    ci_upper = prop.test(fatal_events, total_events)$conf.int[2],
    .groups = "drop"
  ) %>%
  filter(!is.na(driver_experience_cat))

# Visualize experience categories with confidence intervals
experience_plot <- ggplot(experience_stats, aes(x = driver_experience_cat, y = fatality_rate)) +
  geom_bar(stat = "identity", fill = "#3a86ff", alpha = 0.7) +
  geom_errorbar(aes(ymin = ci_lower, ymax = ci_upper), width = 0.2, color = "#e63946") +
  labs(
    title = "Fatality Rate by Driver Experience with 95% Confidence Intervals",
    subtitle = paste("Chi-Square Test: χ²(", experience_chi$parameter, ") = ", 
                    round(experience_chi$statistic, 2), 
                    ", p", ifelse(experience_chi$p.value < 0.001, " < 0.001", 
                                 paste(" = ", round(experience_chi$p.value, 3)))),
    x = "Driver Experience Level",
    y = "Fatality Rate"
  ) +
  scale_y_continuous(labels = scales::percent_format(accuracy = 0.01)) +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),
    plot.subtitle = element_text(hjust = 0.5, size = 12),
    axis.text.x = element_text(angle = 45, hjust = 1)
  )

experience_plot
```

The chi-square test indicates significant differences in fatality rates across driver experience levels (χ²(`r experience_chi$parameter`) = `r round(experience_chi$statistic, 2)`, p `r ifelse(experience_chi$p.value < 0.001, "< 0.001", paste("=", round(experience_chi$p.value, 3)))`). Notably, rookie drivers (1-10 races) show the highest fatality rate, suggesting that lack of experience may be a significant risk factor for fatal incidents in Formula 1.

## 5. Circuit Safety Analysis

We analyze whether certain circuits have significantly higher fatality rates using ANOVA.

```{r circuit-analysis}
# First, identify circuits with enough data
circuit_counts <- stats_data %>%
  group_by(circuit.name) %>%
  summarize(
    total_events = n(),
    fatal_events = sum(is_fatal),
    .groups = "drop"
  ) %>%
  filter(total_events >= 50)  # Focus on circuits with substantial data

# Create factor for top circuits
stats_data <- stats_data %>%
  mutate(
    circuit_factor = ifelse(circuit.name %in% circuit_counts$circuit.name, 
                          circuit.name, "Other")
  )

# ANOVA analysis
circuit_anova <- aov(is_fatal ~ circuit_factor, data = stats_data)
circuit_anova_summary <- summary(circuit_anova)
circuit_tukey <- TukeyHSD(circuit_anova)

# Display ANOVA results
kable(tidy(circuit_anova), caption = "ANOVA Results for Circuit Fatality Rates")

# Calculate circuit-specific fatality rates with CIs
circuit_stats <- stats_data %>%
  group_by(circuit.name) %>%
  summarize(
    total_events = n(),
    fatal_events = sum(is_fatal),
    fatality_rate = fatal_events / total_events,
    # Wilson score interval for proportion CI
    ci_lower = ifelse(total_events >= 5, 
                     prop.test(fatal_events, total_events)$conf.int[1], NA),
    ci_upper = ifelse(total_events >= 5,
                     prop.test(fatal_events, total_events)$conf.int[2], NA),
    .groups = "drop"
  ) %>%
  filter(total_events >= 50) %>%  # Focus on circuits with substantial data
  arrange(desc(fatality_rate))

# Top 10 most dangerous circuits
top_dangerous_circuits <- head(circuit_stats, 10)

# Visualize top dangerous circuits with confidence intervals
circuit_plot <- ggplot(top_dangerous_circuits, aes(x = reorder(circuit.name, fatality_rate), y = fatality_rate)) +
  geom_bar(stat = "identity", fill = "#3a86ff", alpha = 0.7) +
  geom_errorbar(aes(ymin = ci_lower, ymax = ci_upper), width = 0.2, color = "#e63946") +
  geom_text(aes(label = paste0(fatal_events, "/", total_events)), 
            hjust = -0.1, size = 3) +
  labs(
    title = "Top 10 Most Dangerous Circuits (Fatality Rate with 95% CI)",
    subtitle = paste("ANOVA: F(", circuit_anova_summary[[1]]$Df[1], ",", circuit_anova_summary[[1]]$Df[2], ") = ",
                   round(circuit_anova_summary[[1]]$F[1], 2), 
                   ", p", ifelse(circuit_anova_summary[[1]]$Pr[1] < 0.001, " < 0.001", 
                                paste(" = ", round(circuit_anova_summary[[1]]$Pr[1], 3)))),
    x = "Circuit",
    y = "Fatality Rate"
  ) +
  scale_y_continuous(labels = scales::percent_format(accuracy = 0.01), 
                     limits = c(0, max(top_dangerous_circuits$ci_upper) * 1.2)) +
  coord_flip() +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),
    plot.subtitle = element_text(hjust = 0.5, size = 12)
  )

circuit_plot
```

The ANOVA test reveals significant differences in fatality rates across circuits (F(`r circuit_anova_summary[[1]]$Df[1]`, `r circuit_anova_summary[[1]]$Df[2]`) = `r round(circuit_anova_summary[[1]]$F[1], 2)`, p < 0.001). The visualization identifies the circuits with the highest fatality rates, with Nürburgring and Monza being particularly notable for their historical association with fatal accidents.

## 6. Constructor/Team Safety Analysis

We analyze whether certain constructors (teams) have significantly different safety records, focusing on those with fatal events.

```{r constructor-analysis}
# Chi-square test for constructor differences
constructor_counts <- stats_data %>%
  group_by(constructor.name) %>%
  summarize(
    total_events = n(),
    fatal_events = sum(is_fatal),
    .groups = "drop"
  ) %>%
  filter(total_events >= 100, fatal_events > 0)  # Focus on constructors with substantial data and fatal events

# Create factor for these constructors
stats_data <- stats_data %>%
  mutate(
    constructor_factor = ifelse(constructor.name %in% constructor_counts$constructor.name, 
                              constructor.name, "Other")
  )

# Chi-square test for selected constructors
constructor_test <- stats_data %>%
  filter(constructor_factor != "Other") %>%
  group_by(constructor_factor) %>%
  summarize(
    fatal_events = sum(is_fatal),
    non_fatal_events = n() - fatal_events,
    .groups = "drop"
  )

constructor_contingency <- as.matrix(constructor_test[, c("fatal_events", "non_fatal_events")])
rownames(constructor_contingency) <- constructor_test$constructor_factor
constructor_chi <- chisq.test(constructor_contingency)

# Display contingency table
kable(constructor_test, caption = "Fatal Events by Constructor")

# Calculate constructor-specific fatality rates with CIs for those with fatal events
constructor_stats <- stats_data %>%
  group_by(constructor.name) %>%
  summarize(
    total_events = n(),
    fatal_events = sum(is_fatal),
    fatality_rate = fatal_events / total_events,
    # Wilson score interval for proportion CI
    ci_lower = ifelse(total_events >= 30, 
                     prop.test(fatal_events, total_events)$conf.int[1], NA),
    ci_upper = ifelse(total_events >= 30,
                     prop.test(fatal_events, total_events)$conf.int[2], NA),
    .groups = "drop"
  ) %>%
  filter(total_events >= 100, fatal_events > 0) %>%  # Focus on constructors with substantial data and fatal events
  arrange(desc(fatality_rate))

# Visualize constructor fatality rates
constructor_plot <- ggplot(constructor_stats, aes(x = reorder(constructor.name, fatality_rate), y = fatality_rate)) +
  geom_bar(stat = "identity", fill = "#3a86ff", alpha = 0.7) +
  geom_errorbar(aes(ymin = ci_lower, ymax = ci_upper), width = 0.2, color = "#e63946") +
  geom_text(aes(label = paste0(fatal_events, "/", total_events)), 
            hjust = -0.1, size = 3) +
  labs(
    title = "Constructor Fatality Rates with 95% CI",
    subtitle = paste("Chi-Square Test: χ²(", constructor_chi$parameter, ") = ", 
                    round(constructor_chi$statistic, 2), 
                    ", p", ifelse(constructor_chi$p.value < 0.001, " < 0.001", 
                                 paste(" = ", round(constructor_chi$p.value, 3)))),
    x = "Constructor",
    y = "Fatality Rate"
  ) +
  scale_y_continuous(labels = scales::percent_format(accuracy = 0.01), 
                     limits = c(0, max(constructor_stats$ci_upper, na.rm = TRUE) * 1.2)) +
  coord_flip() +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),
    plot.subtitle = element_text(hjust = 0.5, size = 12)
  )

constructor_plot
```

The chi-square test indicates significant differences in fatality rates across constructors (χ²(`r constructor_chi$parameter`) = `r round(constructor_chi$statistic, 2)`, p `r ifelse(constructor_chi$p.value < 0.001, "< 0.001", paste("=", round(constructor_chi$p.value, 3)))`). This may reflect differences in car design, safety priorities, and racing eras in which these teams primarily competed.

## 7. Multivariate Analysis of Fatal Event Risk Factors

Finally, we perform a comprehensive analysis that simultaneously considers multiple factors to identify which remain independently associated with fatal event risk.

```{r multivariate-model}
# Create a comprehensive model combining key factors
# First, prepare complete cases for the model
complete_model_data <- stats_data %>%
  filter(!is.na(driver_age), !is.na(driver_experience)) %>%
  mutate(
    circuit_fatal_history = as.factor(ifelse(circuit.name %in% 
                                     circuit_stats$circuit.name[circuit_stats$fatality_rate > 0], 
                                     "Circuit with Fatal History", "Circuit with No Fatal History")),
    constructor_fatal_history = as.factor(ifelse(constructor.name %in% 
                                        constructor_stats$constructor.name[constructor_stats$fatality_rate > 0], 
                                        "Constructor with Fatal History", "Constructor with No Fatal History"))
  )

# Build the multivariate model
multivariate_model <- glm(is_fatal ~ year + driver_age + driver_experience + 
                          circuit_fatal_history + constructor_fatal_history,
                         family = binomial(link = "logit"), 
                         data = complete_model_data)

# Get model summary
multivariate_summary <- tidy(multivariate_model, conf.int = TRUE, exponentiate = TRUE) %>%
  mutate(across(where(is.numeric), ~round(., 4)))

# Display model results
kable(multivariate_summary, 
      caption = "Multivariate Logistic Regression of Fatal Event Risk Factors",
      col.names = c("Factor", "Odds Ratio", "Std. Error", "z value", "p-value", "Lower 95% CI", "Upper 95% CI"))

# Create a coefficient plot
coef_plot_data <- multivariate_summary %>%
  filter(term != "(Intercept)") %>%
  mutate(
    term = case_when(
      term == "year" ~ "Year (1 year increase)",
      term == "driver_age" ~ "Driver Age (1 year increase)",
      term == "driver_experience" ~ "Driver Experience (1 race increase)",
      term == "circuit_fatal_historyCircuit with No Fatal History" ~ "Circuit with No Fatal History",
      term == "constructor_fatal_historyConstructor with No Fatal History" ~ "Constructor with No Fatal History",
      TRUE ~ term
    ),
    significant = p.value < 0.05
  )

# Create a coefficient plot showing odds ratios
coef_plot <- ggplot(coef_plot_data, aes(x = reorder(term, estimate), y = estimate)) +
  geom_point(aes(color = significant), size = 3) +
  geom_errorbar(aes(ymin = conf.low, ymax = conf.high, color = significant), width = 0.2) +
  geom_hline(yintercept = 1, linetype = "dashed", color = "gray50") +
  scale_color_manual(values = c("TRUE" = "#e63946", "FALSE" = "#3a86ff"),
                    labels = c("TRUE" = "p < 0.05", "FALSE" = "p ≥ 0.05")) +
  coord_flip() +
  labs(
    title = "Multivariate Analysis of Factors Associated with Fatal Events",
    subtitle = "Odds Ratios with 95% Confidence Intervals",
    x = "",
    y = "Odds Ratio (log scale)",
    color = "Statistical Significance"
  ) +
  scale_y_log10(breaks = c(0.1, 0.2, 0.5, 1, 2, 5, 10)) +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),
    plot.subtitle = element_text(hjust = 0.5, size = 12),
    legend.position = "bottom"
  )

coef_plot
```

In the multivariate model, we find that the following factors remain independently associated with fatal event risk:

1. **Year**: For each additional year, the odds of a fatal event decrease by approximately `r abs(round((1-multivariate_summary$estimate[multivariate_summary$term == "year"])*100, 1))`%, indicating substantial safety improvements over time (OR = `r round(multivariate_summary$estimate[multivariate_summary$term == "year"], 4)`, p < 0.001).

2. **Driver Age**: After adjusting for other factors, each one-year increase in driver age is associated with a `r ifelse(multivariate_summary$estimate[multivariate_summary$term == "driver_age"] > 1, "higher", "lower")` risk of fatal events (OR = `r round(multivariate_summary$estimate[multivariate_summary$term == "driver_age"], 4)`, p = `r round(multivariate_summary$p.value[multivariate_summary$term == "driver_age"], 4)`).

3. **Driver Experience**: Each additional race of experience is associated with a `r ifelse(multivariate_summary$estimate[multivariate_summary$term == "driver_experience"] > 1, "higher", "lower")` risk of fatal events (OR = `r round(multivariate_summary$estimate[multivariate_summary$term == "driver_experience"], 4)`, p = `r round(multivariate_summary$p.value[multivariate_summary$term == "driver_experience"], 4)`).

4. **Circuit Fatal History**: Circuits without a history of fatal events are associated with significantly lower risk compared to those with fatal histories (OR = `r round(multivariate_summary$estimate[grepl("circuit_fatal", multivariate_summary$term)], 4)`, p = `r round(multivariate_summary$p.value[grepl("circuit_fatal", multivariate_summary$term)], 4)`).

## 8. Summary of Key Findings

Our statistical analysis of fatal events in Formula 1 from 1950 to 2024 reveals several important patterns:

1. **Temporal Trends**: 
   - Fatal event risk has decreased significantly over time
   - The 1950s and 1960s had the highest fatality rates
   - Safety improvements have dramatically reduced risk since the 1980s

2. **Driver Factors**:
   - Driver age shows a complex relationship with fatal event risk
   - Rookie drivers (1-10 races experience) face significantly higher risk
   - Experience provides a protective effect, independent of age

3. **Circuit Characteristics**:
   - Significant differences exist in fatality rates across circuits
   - Historic circuits like Nürburgring and Monza have higher fatality rates

4. **Constructor Influence**:
   - Teams show significant differences in safety records
   - Some of this variation may be attributed to the era in which they primarily competed

5. **Multivariate Analysis**:
   - Year (reflecting safety improvements over time) is the strongest predictor
   - Circuit safety history remains significant after controlling for other factors
   - Both age and experience independently contribute to driver safety

These findings have implications for ongoing safety efforts in motorsport, highlighting the importance of driver experience, circuit safety features, and continuous improvement in regulations and car design.

## 9. Limitations

Several limitations should be considered when interpreting these results:

1. **Confounding factors**: Many variables are correlated (e.g., year and safety standards)

2. **Rare events**: Fatal events are (fortunately) rare, limiting statistical power. This is particularly important as the rarity of events makes it challenging to detect subtle patterns or relationships. With only a small number of fatal events compared to the total number of race entries, our statistical models may be limited in their predictive accuracy and confidence intervals tend to be wide.

3. **Changing context**: The nature of F1 racing has changed dramatically over the study period

4. **Severity threshold**: Our analysis focuses on fatal events but does not capture non-fatal injuries
